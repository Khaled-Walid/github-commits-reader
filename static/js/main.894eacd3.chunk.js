(this["webpackJsonpcommits-reader"]=this["webpackJsonpcommits-reader"]||[]).push([[0],{106:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(34),o=n.n(r),s=(n(106),n(29)),i=n(7),u=n(13),l=n(97),h=n(5),j=Object(c.createContext)();function b(e){var t=e.children,n=localStorage.getItem("oauthState"),a=localStorage.getItem("oauthAccessToken"),r=Object(c.useState)(n),o=Object(i.a)(r,2),s=o[0],u=o[1],l=Object(c.useState)(a),b=Object(i.a)(l,2),d={oauthState:s,oauthAccessToken:b[0],setOauthState:u,setOauthAccessToken:b[1]};return Object(h.jsx)(j.Provider,{value:d,children:t})}function d(){var e=Object(c.useContext)(j),t=e.oauthState,n=e.oauthAccessToken,a=e.setOauthState,r=e.setOauthAccessToken,o=Object(u.g)();return{oauthState:t,oauthAccessToken:n,startLogin:Object(c.useCallback)((function(e){var t=e.clientId,n=e.redirectUrl,c=Object(l.a)();localStorage.setItem("oauthState",c),localStorage.removeItem("oauthAccessToken"),a(c),r(null);var o=new URLSearchParams({client_id:t,redirect_url:n,scope:"repo,read:user",state:c});window.location="https://github.com/login/oauth/authorize?"+o.toString()}),[a,r]),completeLogin:Object(c.useCallback)((function(e){localStorage.removeItem("oauthState"),localStorage.setItem("oauthAccessToken",e),a(null),r(e),window.location=window.location.origin+window.location.pathname}),[a,r]),logout:Object(c.useCallback)((function(){localStorage.removeItem("oathState"),localStorage.removeItem("oauthAccessToken"),a(null),r(null),o.push("/")}),[a,r,o]),loggedIn:!!n}}var p="016124ae365c55d1ee65",m="1ed9a75880564fcea3c6194d8fabe0d6b63188d9",O="https://khaled-walid.github.io/github-commits-reader",f=n(176);function x(){var e=d(),t=e.loggedIn,n=e.startLogin,a=Object(c.useCallback)((function(){return n({clientId:p,redirectUrl:O+"/#/login-callback"})}),[n]);return t?Object(h.jsx)(u.a,{to:"/"}):Object(h.jsx)(f.a,{variant:"contained",color:"primary",onClick:a,children:"Login"})}function g(){var e=d().logout;return Object(h.jsx)(f.a,{variant:"contained",color:"secondary",onClick:e,children:"Logout"})}var v=n(0),k=n.n(v),w=n(1),S=n(37);function y(e){return function(t){return function(){var e=d().loggedIn,t=Object(u.g)();Object(c.useLayoutEffect)((function(){e||t.push("/login")}),[e,t])}(),Object(h.jsx)(e,Object(S.a)({},t))}}var C=n(171),I=n(172),T=n(173),A=Object(C.a)({root:{minWidth:275,marginTop:"15px",backgroundColor:"#999393"},container:{display:"flex",flexDirection:"column",textAlign:"center"},text:{display:"flex",flexDirection:"column",textAlign:"center"}});var L=y((function(){var e=d(),t=e.oauthAccessToken,n=e.loggedIn,a=Object(c.useState)(null),r=Object(i.a)(a,2),o=r[0],s=r[1],l=Object(c.useState)(null),j=Object(i.a)(l,2),b=j[0],p=j[1],m=Object(c.useCallback)(Object(w.a)(k.a.mark((function e(){var n,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/user",{headers:{accept:"application/json",Authorization:"token "+t}});case 2:return n=e.sent,e.next=5,n.json();case 5:return c=e.sent,e.abrupt("return",c.login);case 7:case"end":return e.stop()}}),e)}))),[t]),O=Object(c.useCallback)(function(){var e=Object(w.a)(k.a.mark((function e(n){var c,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/search/repositories?q=user:"+n,{headers:{accept:"application/json",Authorization:"token "+t}});case 2:return c=e.sent,e.next=5,c.json();case 5:return a=e.sent,e.abrupt("return",a.items.map((function(e){return{id:e.id,name:e.name,fullName:e.full_name,cloneUrl:e.clone_url}})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);Object(c.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return t=e.sent,e.next=5,O(t);case 5:n=e.sent,s(t),p(n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n&&function(){e.apply(this,arguments)}()}),[O,m,n]);var x=A(),g=Object(u.g)(),v=b&&b.map((function(e){return Object(h.jsx)(f.a,{className:x.root,variant:"outlined",onClick:function(){g.push("/".concat(e.fullName))},children:e.name},e.id)}));return b?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(I.a,{className:x.text,variant:"h5",component:"h2",children:["Username: ",o," ",Object(h.jsx)("br",{}),"Repositories:"]}),Object(h.jsx)(T.a,{className:x.container,children:v})]}):"Loading..."})),_=n(177),E=n(175),N=n(174),P=n(90),F=n.n(P),U=n(91),D=new F.a("commit-renamer"),B=U.a,W="https://cors.isomorphic-git.org",z=n(63);function J(e,t,n){return"https://".concat(e,"@github.com/").concat(t,"/").concat(n,".git")}var R=Object(C.a)({li:{color:"white"}});var M=y((function(){var e=d().oauthAccessToken,t=Object(u.i)(),n=t.username,a=t.reponame,r=Object(c.useState)(!0),o=Object(i.a)(r,2),s=o[0],l=o[1],j=Object(c.useState)(!0),b=Object(i.a)(j,2),p=b[0],m=b[1],O=Object(c.useState)(null),x=Object(i.a)(O,2),g=x[0],v=x[1],S="/".concat(n,"/").concat(a);Object(c.useEffect)((function(){function t(){return(t=Object(w.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D.promises.stat("/"+n);case 3:t.next=9;break;case 5:return t.prev=5,t.t0=t.catch(0),t.next=9,D.promises.mkdir("/"+n);case 9:return t.prev=9,t.next=12,D.promises.stat(S);case 12:t.next=18;break;case 14:return t.prev=14,t.t1=t.catch(9),t.next=18,z.a.clone({fs:D,http:B,corsProxy:W,dir:S,url:J(e,n,a)});case 18:l(!1);case 19:case"end":return t.stop()}}),t,null,[[0,5],[9,14]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,a,n,S]),Object(c.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.a.log({fs:D,dir:S});case 2:t=e.sent,n=t.map((function(e){return{sha:e.oid,message:e.commit.message,author:e.commit.author}})),v(n),m(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[s,S]);var y=R(),C=g&&g.map((function(e){return Object(h.jsx)("li",{children:Object(h.jsxs)(I.a,{className:y.li,children:["Message: ",e.message," ",Object(h.jsx)("br",{}),"User: ",e.author.name," ",Object(h.jsx)("br",{}),"E-mail: ",e.author.email," ",Object(h.jsx)("br",{}),"Date: ",new Date(1e3*e.author.timestamp).toString()]})},e.sha)})),T=C?Object(h.jsx)("ul",{children:C}):null,A=Object(u.g)();return p?"Loading...":Object(h.jsxs)(h.Fragment,{children:[T,Object(h.jsx)(f.a,{variant:"contained",color:"default",onClick:function(){A.goBack()},children:"Back"})]})})),q=Object(C.a)({root:{minWidth:275,marginTop:"20%",backgroundColor:"#646464"}});function Y(){var e=d().loggedIn,t=q(),n=e?Object(h.jsx)(g,{}):Object(h.jsx)(x,{});return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(T.a,{maxWidth:"sm",children:Object(h.jsxs)(_.a,{className:t.root,variant:"outlined",children:[Object(h.jsx)(N.a,{children:e?Object(h.jsxs)(u.d,{children:[Object(h.jsx)(u.b,{exact:!0,path:"/",children:Object(h.jsx)(L,{})}),Object(h.jsx)(u.b,{exact:!0,path:"/:username/:reponame",children:Object(h.jsx)(M,{})})]}):Object(h.jsx)(I.a,{variant:"h5",component:"h2",children:"You are not logged in!"})}),Object(h.jsx)(E.a,{children:n})]})})})}var G="https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token";function H(){var e=Object.fromEntries(new URLSearchParams(Object(u.h)().search).entries()),t=d(),n=t.loggedIn,a=t.oauthState,r=t.completeLogin,o=Object(c.useState)(null),s=Object(i.a)(o,2),l=s[0],j=s[1],b=Object(c.useState)(!1),f=Object(i.a)(b,2),x=f[0],g=f[1],v=!!window.location.search;if(Object(c.useEffect)((function(){function t(){return c.apply(this,arguments)}function c(){return(c=Object(w.a)(k.a.mark((function n(){var c,a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(G,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify({client_id:p,client_secret:m,code:e.code,redirect_url:O+"/#/login-callback"})});case 3:if(403!==(c=n.sent).status){n.next=12;break}return n.next=7,c.text();case 7:if(!n.sent.indexOf("/corsdemo")){n.next=12;break}return g(!0),setTimeout(t,1e3),n.abrupt("return");case 12:return g(!1),n.next=15,c.json();case 15:(a=n.sent).error?j(a.error_description):r(a.access_token),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(0),j(n.t0.toString());case 22:case"end":return n.stop()}}),n,null,[[0,19]])})))).apply(this,arguments)}v||(e.error?j(e.error_description):!n&&a&&e.state===a&&e.code&&t())}),[v,n,a,r,e.state,e.error,e.error_description,e.code]),v){var S=window.location,y=S.origin,C=S.pathname,I=S.hash,T=S.search;return window.location=y+C+I+T,null}return n?Object(h.jsx)(u.a,{to:"/"}):e.state===a&&a?x?Object(h.jsxs)("div",{children:["Please click on the button below",Object(h.jsx)("iframe",{title:"cors-anywhere",src:"https://cors-anywhere.herokuapp.com/",width:"800",height:"600"})]}):l||"Loading...":"Wrong state"}var K=function(){return Object(h.jsx)(b,{children:Object(h.jsx)(s.a,{children:Object(h.jsxs)(u.d,{children:[Object(h.jsx)(u.b,{exact:!0,path:"/login-callback",children:Object(h.jsx)(H,{})}),Object(h.jsx)(u.b,{path:"/",children:Object(h.jsx)(Y,{})})]})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,179)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))};o.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(K,{})}),document.getElementById("root")),Q()}},[[151,1,2]]]);
//# sourceMappingURL=main.894eacd3.chunk.js.map